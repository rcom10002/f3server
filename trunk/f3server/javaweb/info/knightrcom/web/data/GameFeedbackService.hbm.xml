<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
	<sql-query name="GAME_FEEDBACK">
	<![CDATA[
		SELECT 
			   GF.FEEDBACK_ID feedbackId,
			   GF.GAME_ID gameId,
		       GR.GAME_TYPE gameType,
		       GF.TITLE title,
		       CASE
	            WHEN GF.STATUS ='NEW_ARRIVAL' THEN '未处理'
	            WHEN GF.STATUS ='IN_PROGRESS' THEN '处理中'
	            WHEN GF.STATUS ='DONE' THEN '处理毕'
	           END status,
	           GF.STATUS statusIndex,
		       HOUR(TIMEDIFF(NOW(), GF.CREATE_TIME)) hours,
		       DATE_FORMAT(GF.CREATE_TIME, "%Y年%m月%d日%H时%i分%S秒") createTime,
		       PP.NAME name
		  FROM GAME_FEEDBACK GF, GAME_RECORD GR, PLAYER_PROFILE PP
		 WHERE GF.GAME_ID = GR.GAME_ID
		   AND GF.CREATE_BY = PP.PROFILE_ID
		   AND (? = '' or GF.STATUS = ?)
		   AND GF.CREATE_TIME BETWEEN ? AND DATE_ADD(?, INTERVAL 1 DAY)
		   AND UPPER(GF.TITLE) LIKE UPPER(?)
		 ORDER BY GF.CREATE_TIME DESC
    ]]>
    </sql-query>
	<sql-query name="GAME_FEEDBACK_COUNT">
	<![CDATA[
		SELECT COUNT(*) RECORD_COUNT
		  FROM GAME_FEEDBACK GF, GAME_RECORD GR, PLAYER_PROFILE PP
		 WHERE GF.GAME_ID = GR.GAME_ID
		   AND GF.CREATE_BY = PP.PROFILE_ID
		   AND (? = '' or GF.STATUS = ?)
		   AND GF.CREATE_TIME BETWEEN ? AND DATE_ADD(?, INTERVAL 1 DAY)
		   AND UPPER(GF.TITLE) LIKE UPPER(?)
    ]]>
    </sql-query>
</hibernate-mapping>
